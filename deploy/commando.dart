import "dart:html" as TB;import "dart:math" as qB;import "dart:async" as TC;import "dart:typed_data" as oC;class RE{const RE();}class SE{final  name;const SE(this.name);}class TE{const TE();} main(){var i=TB.query("#area");var g=new WD();u.gD=i;u.eD(g);TB.window.setImmediate(u.iD);}class WD implements VC{var map=new UC(); GD(){for(int k=0;k<1;k++ ){var i=new rB();i.position.JB(200.0+30.0*k,500.0);i.ID="red";nD.add(i);map.cC(i);u.tC.where((g)=>(g.type==v.rC&&g.body is pC)).listen((g)=>i.attack(g.body));i.RC(v.sC).listen((g)=>EE(g));}} EE( g){if(PC.length>0){var i=g.body as rB;i.attack(PC.first);}} QD(){u.gD.onClick.listen((g)=>onClick(g));u.tC.listen((g)=>PC.remove(g.body));}var aE=new qB.Random(); onClick( i){print("click ${i.offset.x},${i.offset.y}");var g=new pC();g.position.JB(i.offset.x.toDouble(),i.offset.y.toDouble());var k=50.0;var t=3.2;g.CB=30.0;g.color="blue";g.EC=true;g.o.JB(k*qB.cos(t),k*qB.sin(t));PC.add(g);map.cC(g);}var nD=[] ;var PC=[] ;}class UE extends WC{ get eB=>3.0;UE(){CB=3.0;}}class XD extends MB{var AE=false; update( g){if(AE){o.scale(-o.length*500*g);}super.update(g);}}class rB extends UB{var hE=new XD();var uC=30.0;var kD;rB(){KB=1000.0;bB=0.0;DC=10000;points=[new j(25.0,0.0),new j(25.0,10.0),new j(-25.0,20.0),new j(-25.0,-20.0),new j(25.0,-10.0),new j(25.0,0.0)];oB={"x+":[new j(-25.0,4.0),new j(-25.0,-4.0)],"y-":[new j(-5.0,15.0),new j(-7.0,15.0)],"y+":[new j(-7.0,-15.0),new j(-5.0,-15.0)],"x-":[new j(25.0,-1.0),new j(25.0,1.0)]};cB=new qC(host:this,projectileType:()=>new UE());kD=new TC.Timer.periodic(new Duration(milliseconds:200),(g)=>tD());}var oB;var ID="#cccccc"; attack( g){super.attack(g);print("I will attack ${g}");}var SB; OB( g){var i=AB.CC();force+= i.pB;bB+= AB.CC().z/DC*g;super.OB(g);} XB( g,[ i]){if(AB.QB.x<1.0)zB(oB["x-"],-.2,g,i);else zB(oB["x+"],AB.QB.x/80000.0,g,i);if(AB.QB.y<1.0)zB(oB["y-"],-.2,g,i);else zB(oB["y+"],.2,g,i);g.fillStyle=ID;super.XB(g);}var JE=new qB.Random();var CD=["#FFC425","#FF9932","#E86922","#FF5325"]; zB( t, SC, i,[ nC]){i.fillStyle=CD[JE.nextInt(CD.length)];i.beginPath();var k=t[0];var g=t[1]-k;var dB=new j(g.y,-g.x);dB.scale(100.0/g.length);var DB=k+g.scale(0.5)+dB.scale(SC.toDouble());k=GB*t[0]+position;DB=GB*DB+position;g=GB*t[1]+position;i.moveTo(k.x,k.y);i.lineTo(DB.x,DB.y);i.lineTo(g.x,g.y);i.closePath();i..fill()..stroke();}}class v{static const  rC="dudeAdded";static const  YC="dudeRemoved";static const  sC="dudeIdle";var type;var body;var location;v({this.type,this.body,this.location});}class YD{final  lC=qB.PI*2.0;var QC=80000.0;var SD=20000.0;var kC=20000.0;var bE=20000.0;var qE=false;var rE=false;var sE=0.7071;var tE=0.1;var uE=150.0;var vE;var MC;var OC;var mB;var HC=new j.eE();var AC=new n.eE();var FB;YD(this.FB); CC(){var k=new m.eE();var g;if(MC!=null){var i=FB.position-MC;rE=i.fC>vE;if(false&&rE){var DB=i.kB(-yC/i.length);AC.KC();AC.LE(1,FB.o-DB);}else AC.ME(i,FB.o-OC);g=AC*HC;var t=zD(g);k.pB=FB.GB*t;if(!qE&&t.length*2.5<g.length)qE=true;if(qE&&g.length<kC)qE=false;}mB=qE&&g!=null?qB.atan2(g.y,g.x):mB;k.z=yD();return k;}var QB=new j.eE(); zD( i){QB=FB.GB.PE()*i;var g=QB;if(g.x>QC)g.x=QC;else if(g.x<-SD)g.x=-SD;if(g.y.abs()>kC)g.y=kC*(g.y>0?1:-1);return g;} yD(){if(mB==null)return 0.0;var g=(FB.nB-mB)%lC;if(g<-qB.PI)g+= lC;else if(g>qB.PI)g-= lC;var i=-FB.DC*(4.0*sE*tE*FB.bB+4.0*tE*tE*g);return i;}set rD( g){sE=g.toDouble();wB();}set CE( g){tE=g.toDouble();wB();} get yC=>uE; wB(){HC.JB(-tE*tE*FB.KB,-2.0*sE*tE*FB.KB);vE=qB.pow(1.1*(HC.DD*yC-QC)/HC.r,2.0);print("Stopping dist: ${qB.sqrt(vE)}");}}class UC{var gB=[] ;var context;var lE;var width;var height; get top=>0.0; get left=>0.0; get right=>width; get bottom=>height;var fB; cC( i){gB.add(i);var g=i as l;if(g!=null){fB.insert(g);u.jD(g);}} IE( i){gB.remove(i);var g=i as l;if(g!=null){if(!fB.remove(g)){print("WARNING: could not find ${g} in quadtree");}}} DE( i){context.clearRect(0,0,width,height);context..lineWidth=0.5;fB.update();fB.vC();for(HB g in gB)g.OB(i);for(HB g in gB)g.XB(context);for(HB g in gB)g.mC();} set canvas( i){lE=i;width=lE.width;height=lE.height;var g=lE.parent.client;width=g.width;height=g.height;lE.width=width;fB=new LB(right:width,bottom:height);context=lE.context2D;}}abstract class VC{var map; GD(); QD();}class u{static var sB;var iE;var map;var kE;var EB=new TC.StreamController<v>.broadcast();var lE;static  get q{if(sB==null)sB=new u();return sB;}static  eD( g){g.map.canvas=q.lE;q.kE=g;q.kE.GD();q.map=g.map;}static  set gD( g){q.lE=g;if(q.kE!=null&&q.kE.map!=null)q.kE.map.canvas=g;}static  get gD=>q.lE;static  iD(){if(q.lE==null||q.kE==null)throw "Can't start without canvas and level set.";TB.window.animationFrame.then(sB.xD);} xD( g){iE=g;q.kE.QD();TB.window.animationFrame.then(ED);} ED( g){var i=(g-iE)/1000.0;iE=g;map.DE(i);TB.window.animationFrame.then(ED);}static  jD( g){var i=new v(type:v.rC,body:g);i.location=new j.fE(g.position);q.EB.add(i);}static  bC( g){q.map.IE(g as HB);var i=new v(type:v.YC,body:g);i.location=new j.fE(g.position);q.EB.add(i);}static  get tC=>q.EB.stream;}class LB{static final  aD=6;static final  bD=4;static final  dD=4;static var ZC=new List<List<LB>>();static var aC=new List<l>();var top,left,bottom,right;var ZB=0,RB=0;var hB,iB;var s=new List<l>();var nodes;var parent;static var uB=1;static var fD=0;LB({this.top: 0,this.left: 0,this.bottom: 0,this.right: 0}); vC([ g]){var k;var i;var UD=0,nC=0;if(g==null)g=[] ;for(int DB=0;DB<s.length;DB++ ){k=s[DB];if(!k.YB)continue;for(int dB=DB+1;dB<s.length;dB++ ){i=s[dB];UD++ ;if(i.YB)KD(k,i);}for(l i in g){if(i.YB)KD(k,i);nC++ ;}}if(nodes!=null){var t=new List<l>(g.length+s.length);t.setRange(0,g.length,g);t.setRange(g.length,t.length,s);for(LB QE in nodes)QE.vC(t);}var SC=right-left;var VD=bottom-top;var cE=1-4*(SC/2-40.0)*(VD/2-40.0)/(SC-40.0)/(VD-40.0);var dE=s.length.toDouble()/RB.toDouble();fD+= nC+UD;} KD( g, i){g.jB(i);i.jB(g);} split(){hB=(right+left)/2;iB=(bottom+top)/2;if(ZC.length==0){nodes=new List<LB>();for(int g=0;g<4;g++ )nodes.add(new LB());}else nodes=ZC.removeLast();for(int g=0;g<4;g++ ){if(g<2){nodes[g]..top=top..bottom=iB;}else{nodes[g]..bottom=bottom..top=iB;}if(g%2==0){nodes[g]..left=left..right=hB;}else{nodes[g]..right=right..left=hB;}nodes[g]..parent=this..ZB=ZB+1..RB=0;}PD();uB+= 4;} PD(){var i;for(int g=s.length-1;g>=0;g-- ){if((i=eC(s[g]))!=-1)nodes[i].insert(s.removeAt(g));}} insert( g){var k;RB++ ;if(nodes!=null&&(k=eC(g))!=-1){nodes[k].insert(g);return;}s.add(g);if(s.length>aD&&ZB<dD&&nodes==null){split();var t=nodes.map((i)=>i.s.length).join(',');var DB=nodes.map((i)=>i.RB).join(',');print("split lev:${ZB}, n:${s.length}, sn:${t} sncc:${t} cc:${RB}");}} remove( g){var i;if(nodes==null||(i=eC(g))==-1){if(s.remove(g)){hC();return true;}else return false;}else return nodes[i].remove(g);} wC(){var k;if(ZB!=0)for(int g=s.length-1;g>=0;g-- ){if(s[g].BB.top<top||s[g].BB.bottom>bottom||s[g].BB.left<left||s[g].BB.right>right){aC.add(s.removeAt(g));hC();}}if(nodes!=null){for(LB i in nodes)i.wC();PD();}} update(){wC();for(int g=aC.length-1;g>=0;g-- ){insert(aC.removeAt(g));}xC();} xC(){if(nodes!=null){if(RB<bD){TD();print("node at level ${ZB} was unsplit, count:${s.length}");print("nodecount ${uB} avg:${100/uB},");}else for(LB g in nodes)g.xC();}} TD(){if(nodes!=null){for(LB g in nodes){s.addAll(g.TD());g.s.clear();}ZC.add(nodes);nodes=null;uB-= 4;}return s;} eC( g){var i=0;if(g.BB.top>iB){i=2;}else if(g.BB.bottom>iB)return -1;if(g.BB.left>hB){i++ ;}else if(g.BB.right>hB)return -1;return i;} hC(){RB-- ;if(parent!=null)parent.hC();}}class pC extends UB implements l{var color="black";var CB=1.0;var FC=false;var EB=new TC.StreamController<v>.broadcast(); XB( g,[ i]){color=FC?"#ff0000":"#0000ff";g..fillStyle=color..strokeStyle=color..beginPath()..arc(position.x,position.y,CB,0,qB.PI*2,false)..fill()..closePath();} jB( g){if((g.position-position).fC<CB*CB){g.IC(this);RD();}} IC( g){RD();} RD(){if(CB>5)CB-= 5;else HE();} HE(){print("disc removing self");var g=new v(body:this,type:v.YC);EB.add(g);u.bC(this);}}class WC extends HB implements l{var jE=1; get eB=>-1.0;var color="black";var pE;var YB=true;var EC=false;var FC=false; get CB=>jE;var BB;var AD;var EB; lD(){if(eB>=0){AD=new TC.Timer(new Duration(milliseconds:(eB*1000).toInt()),()=>uD());}}set CB( g){jE=g;BB..width=2*g..height=2*g;}WC(){pE=new MB();BB=new vB(CB,CB);BB.WB=position;EB=new TC.StreamController<v>.broadcast();} XB( g,[ i]){color=FC?"#ff0000":"#0000ff";g..fillStyle=color..strokeStyle=color..beginPath()..arc(position.x,position.y,CB,0,qB.PI*2,false)..fill()..closePath();} jB( g){} IC( g){YB=false;AD.cancel();u.bC(this);} mC(){FC=false;} uD(){u.bC(this);} get position=>pE.position; get o=>pE.o; OB( g){if(EC){if(position.x>u.q.map.right&&pE.o.x>0)pE.IB(new j(0.0,1.0));if(position.x<u.q.map.left&&pE.o.x<0)pE.IB(new j(0.0,1.0));if(position.y<u.q.map.bottom&&pE.o.y>0)pE.IB(new j(1.0,0.0));if(position.y<u.q.map.top&&pE.o.y<0)pE.IB(new j(1.0,0.0));}pE.update(g);} RC( i)=>EB.stream.where((g)=>g.type==i);}class ZD{var host;var controller;var HD=false;ZD(this.host){controller=new YD(host);controller.rD=0.85;controller.CE=2.0;}var NB=new j.eE();var aB=new j.eE();var BE; iC({ position, theta, velocity}){controller.qE=!HD;if(theta!=null&&!theta.isNaN){BE=theta;controller.mB=theta;}if(position!=null){NB=position;controller.MC=position;}if(velocity!=null){aB=velocity;controller.OC=velocity;}else controller.OC=null;} KE( i, g){g.PB.dC(NB);NB.gC().normalize();aB.JB(-NB.y,NB.x);var k=qB.sqrt(controller.QC/2*g.LD/host.KB);if(g.NC.xB(g.PB)>0.0)k*= -1.0;aB.scale(k);if(i is MB)aB.add((i as MB).o);NB.scale(g.LD).add(i.position);controller.MC=NB;controller.OC=aB;var t=(NB-i.position).xB(aB);} pD(){} qD( g){} CC()=>controller.CC(); get QB=>controller.QB;}typedef  XC();class qC{var XE;var ND;var MD;var host;static const  tB=150.0;var oE;var BC;qC({this.host, projectileType}){this.GE=projectileType;}var SB=0.0;var PB;var NC;var jC;var JC;var zC; FE( g){PB=g.position-host.position;JC=PB.length;zC=(host.o.yB(PB)/JC+tB)*MD;NC=(g as MB).o-host.o;jC=1.0/NC.JD();if(zC<JC)return 0.0;var i=oD(g);if(SB.isNaN)return 0.0;return qB.pow(i,2.0);} get LD=>ND*.6; oD( k){SB=qB.atan2(PB.y,PB.x);if(k is MB){if(jC>.1){var g=PB.xB(NC)/JC;var i=jC/tB*g;SB+= qB.asin(i);return g;}}return 1.0;} wD(){if(!SB.isNaN&&(host.nB-SB).abs()<1.0)vD();} vD(){var g=oE();g.o.JB(tB,0.0);host.GB.transform(g.o).add(host.o);g.position.JB(host.uC+1.0,0.0);host.GB.transform(g.position).add(host.position);u.q.map.cC(g);g.lD();}var BF=false;set BD( g){if(g&&!BF){print("firer created");BC=new TC.Timer.periodic(new Duration(milliseconds:500),(i)=>wD());}else if(!g&&BF){print("firer ${BC} will be canceled");if(BC!=null)BC.cancel();}BF=g;}set GE( g){oE=g;ND=tB*g().eB;MD=g().eB;}}abstract class HB{var position=new j.eE(); XB( i,[ g]); OB( g); mC();}class UB extends cD implements l,MB{var YE=1.0;var nE;var EB=new TC.StreamController<v>.broadcast();var BB=new vB(50,50);var uC=1.0;var pE;var YB=true;var EC=false;var GC=false;var wE;var AB;var WE;var cB;UB(){pE=new MB();BB.WB=position;AB=new ZD(this);} moveTo( g,[ i=null]){AB.iC(position:g,theta:i,velocity:new j.eE());} attack( g){nE=g;g.RC(v.YC).listen((i)=>mD());} mD(){print("dude ${this} idle");nE=null;cB.BD=false;AB.pD();var g=new v(type:v.sC,body:this);EB.add(g);} tD(){if(nE is l){var i=nE;var g=cB.FE(i);if(g<.5){print("follow mode");GC=false;}else if(g>.75){print("shot mode");GC=true;}cB.BD=g>.10;AB.HD=GC;if(GC)AB.iC(theta:cB.SB);AB.KE(i,cB);}else if(nE is j){var k=nE;AB.iC(position:k,velocity:new j.eE());}} jB( g){AB.qD(g);} IC( g){} OB( g){if(EC){if(position.x>u.q.map.right&&o.x>0)pE.IB(new j(1.0,0.0));if(position.x<u.q.map.left&&o.x<0)pE.IB(new j(1.0,0.0));if(position.y>u.q.map.bottom&&o.y>0)pE.IB(new j(0.0,1.0));if(position.y<u.q.map.top&&o.y<0)pE.IB(new j(0.0,1.0));}pE.update(g);super.OB(g);} update( g)=>OB(g); get KB=>pE.KB;set KB( g){pE.KB=g;AB.controller.wB();} get DC=>wE;set DC( g){wE=g;AB.controller.wB();} get position=>pE.position; get o=>pE.o; get force=>pE.force;set force( g)=>pE.force=g; RC( i)=>EB.stream.where((g)=>g.type==i); IB( g)=>pE.IB(g);}class cD extends HB implements hD{var mE=0;var bB;var VE;var GB=new n.gE();var points; get nB=>mE;set nB( g){GB.OE(g);mE=g;} XB( i,[ t]){var g=GB*points[0]+position;i.beginPath();i.moveTo(g.x,g.y);for(int k=1;k<points.length;k++ ){g=GB*points[k]+position;i.lineTo(g.x,g.y);}i.closePath();i..fill()..stroke();} OB(g){if(bB!=null){nB+= bB*g;}} mC(){}}class MB{var KB=1;var position=new j.eE();var o=new j.eE();var force=new j.eE(); update( g){o.add(force.scale(g/KB));position.add(o.kB(g));force.KC();} IB( g){o.OD(g);}}abstract class hD{var nB;var bB; get GB;}class vB{vB( g, i){this.width=g;this.height=i;} get top=>WB.y-xE; get left=>WB.x-yE; get bottom=>WB.y+xE; get right=>WB.x+yE;var zE; get width=>zE;set width( g){zE=g;yE=g/2;}var AF; get height=>zE;set height( g){AF=g;xE=g/2;}var xE;var yE;var WB; toString()=>"t:${top}, l:${left}, b:${bottom}, r:${right}";}abstract class l{ get YB; jB( g); IC( g); get BB; get position; RC( g);}class j{final  h=new oC.Float32List(2);j( i, g){JB(i,g);}j.eE();j.fE( g){lB(g);} JB( i, g){h[0]=i;h[1]=g;return this;} KC(){h[0]=0.0;h[1]=0.0;return this;} lB( g){h[1]=g.h[1];h[0]=g.h[0];return this;} toString()=>'[${h[0]},${h[1]}]'; operator-()=>new j(-h[0],-h[1]); operator-( g)=>new j(h[0]-g.h[0],h[1]-g.h[1]); operator+( g)=>new j(h[0]+g.h[0],h[1]+g.h[1]); operator/( i){var g=1.0/i;return new j(h[0]*g,h[1]*g);} operator*( i){var g=i;return new j(h[0]*g,h[1]*g);} operator[]( g)=>h[g]; operator[]=( i, g){h[i]=g;} get length{var g;g=(h[0]*h[0]);g+= (h[1]*h[1]);return qB.sqrt(g);} get fC{var g;g=(h[0]*h[0]);g+= (h[1]*h[1]);return g;} normalize(){var g=length;if(g==0.0){return this;}g=1.0/g;h[0]*=g;h[1]*=g;return this;} JD(){var g=length;if(g==0.0){return 0.0;}g=1.0/g;h[0]*=g;h[1]*=g;return g;} yB( i){var g;g=h[0]*i.h[0];g+= h[1]*i.h[1];return g;} xB( g){return h[0]*g.h[1]-h[1]*g.h[0];} OD( g){LC(g.kB(2*g.yB(this)));return this;} get isNaN{var g=false;g=g||h[0].isNaN;g=g||h[1].isNaN;return g;} add( g){h[0]=h[0]+g.h[0];h[1]=h[1]+g.h[1];return this;} LC( g){h[0]=h[0]-g.h[0];h[1]=h[1]-g.h[1];return this;} scale( g){h[1]=h[1]*g;h[0]=h[0]*g;return this;} kB( g){return clone().scale(g);} gC(){h[1]=-h[1];h[0]=-h[0];return this;} clone(){return new j.fE(this);} dC( g){g.h[1]=h[1];g.h[0]=h[0];return g;}set pB( g){h[0]=g.h[0];h[1]=g.h[1];}set x( g)=>h[0]=g;set y( g)=>h[1]=g; get pB=>new j(h[0],h[1]); get r=>h[0]; get DD=>h[1]; get x=>h[0]; get y=>h[1];}class m{final  h=new oC.Float32List(3);m( k, i, g){JB(k,i,g);}m.eE();m.fE( g){lB(g);} JB( k, i, g){h[0]=k;h[1]=i;h[2]=g;return this;} KC(){h[2]=0.0;h[1]=0.0;h[0]=0.0;return this;} lB( g){h[0]=g.h[0];h[1]=g.h[1];h[2]=g.h[2];return this;} toString()=>'[${h[0]},${h[1]},${h[2]}]'; operator-()=>new m(-h[0],-h[1],-h[2]); operator-( g)=>new m(h[0]-g.h[0],h[1]-g.h[1],h[2]-g.h[2]); operator+( g)=>new m(h[0]+g.h[0],h[1]+g.h[1],h[2]+g.h[2]); operator/( i){var g=1.0/i;return new m(h[0]*g,h[1]*g,h[2]*g);} operator*( i){var g=i;return new m(h[0]*g,h[1]*g,h[2]*g);} operator[]( g)=>h[g]; operator[]=( i, g){h[i]=g;} get length{var g;g=(h[0]*h[0]);g+= (h[1]*h[1]);g+= (h[2]*h[2]);return qB.sqrt(g);} get fC{var g;g=(h[0]*h[0]);g+= (h[1]*h[1]);g+= (h[2]*h[2]);return g;} normalize(){var g=length;if(g==0.0){return this;}g=1.0/g;h[0]*=g;h[1]*=g;h[2]*=g;return this;} JD(){var g=length;if(g==0.0){return 0.0;}g=1.0/g;h[0]*=g;h[1]*=g;h[2]*=g;return g;} yB( i){var g;g=h[0]*i.h[0];g+= h[1]*i.h[1];g+= h[2]*i.h[2];return g;} xB( g){var CF=h[0];var DF=h[1];var EF=h[2];var i=g.h[0];var t=g.h[1];var k=g.h[2];return new m(DF*k-EF*t,EF*i-CF*k,CF*t-DF*i);} OD( g){LC(g.kB(2*g.yB(this)));return this;} get isNaN{var g=false;g=g||h[0].isNaN;g=g||h[1].isNaN;g=g||h[2].isNaN;return g;} add( g){h[0]=h[0]+g.h[0];h[1]=h[1]+g.h[1];h[2]=h[2]+g.h[2];return this;} LC( g){h[0]=h[0]-g.h[0];h[1]=h[1]-g.h[1];h[2]=h[2]-g.h[2];return this;} scale( g){h[2]=h[2]*g;h[1]=h[1]*g;h[0]=h[0]*g;return this;} kB( g){return clone().scale(g);} gC(){h[2]=-h[2];h[1]=-h[1];h[0]=-h[0];return this;} clone(){return new m.fE(this);} dC( g){g.h[0]=h[0];g.h[1]=h[1];g.h[2]=h[2];return g;}set pB( g){h[0]=g.h[0];h[1]=g.h[1];}set x( g)=>h[0]=g;set y( g)=>h[1]=g;set z( g)=>h[2]=g; get pB=>new j(h[0],h[1]); get r=>h[0]; get DD=>h[1]; get x=>h[0]; get y=>h[1]; get z=>h[2];}class n{final  h=new oC.Float32List(4); index( g, i)=>(i*2)+g; entry( g, i)=>h[index(g,i)];n.eE();n.gE(){NE();}n.fE( g){lB(g);} ME( i, g){h[0]=i.h[0];h[1]=i.h[1];h[2]=g.h[0];h[3]=g.h[1];return this;} lB( g){h[3]=g.h[3];h[2]=g.h[2];h[1]=g.h[1];h[0]=g.h[0];return this;} toString(){var g='';g='${g}[0] ${FD(0)}\n';g='${g}[1] ${FD(1)}\n';return g;} get sD=>2; operator[]( g)=>h[g]; operator[]=( i, g){h[i]=g;} FD( i){var g=new j.eE();g.h[0]=h[index(i,0)];g.h[1]=h[index(i,1)];return g;} LE( k, i){var g=k*2;h[g+1]=i.h[1];h[g+0]=i.h[0];} clone(){return new n.fE(this);} dC( g){g.h[0]=h[0];g.h[1]=h[1];g.h[2]=h[2];g.h[3]=h[3];return g;} FF( i){var g=new n.eE();g.h[3]=h[3]*i;g.h[2]=h[2]*i;g.h[1]=h[1]*i;g.h[0]=h[0]*i;return g;} GF( g){var i=new n.eE();i.h[0]=(h[0]*g.h[0])+(h[2]*g.h[1]);i.h[2]=(h[0]*g.h[2])+(h[2]*g.h[3]);i.h[1]=(h[1]*g.h[0])+(h[3]*g.h[1]);i.h[3]=(h[1]*g.h[2])+(h[3]*g.h[3]);return i;} HF( g){var i=new j.eE();i.h[1]=(h[1]*g.h[0])+(h[3]*g.h[1]);i.h[0]=(h[0]*g.h[0])+(h[2]*g.h[1]);return i;} operator*( g){if(g is double){return FF(g);}if(g is j){return HF(g);}if(2==g.sD){return GF(g);}throw new ArgumentError(g);} operator+( i){var g=new n.eE();g.h[0]=h[0]+i.h[0];g.h[1]=h[1]+i.h[1];g.h[2]=h[2]+i.h[2];g.h[3]=h[3]+i.h[3];return g;} operator-( i){var g=new n.eE();g.h[0]=h[0]-i.h[0];g.h[1]=h[1]-i.h[1];g.h[2]=h[2]-i.h[2];g.h[3]=h[3]-i.h[3];return g;} operator-(){var g=new n.eE();g[0]=-h[0];g[1]=-h[1];return g;} KC(){h[0]=0.0;h[1]=0.0;h[2]=0.0;h[3]=0.0;return this;} NE(){h[0]=1.0;h[1]=0.0;h[2]=0.0;h[3]=1.0;return this;} PE(){var g=new n.eE();g.h[0]=h[0];g.h[1]=h[2];g.h[2]=h[1];g.h[3]=h[3];return g;} OE( g){var i=qB.cos(g);var k=qB.sin(g);h[0]=i;h[1]=k;h[2]=-k;h[3]=i;} add( g){h[0]=h[0]+g.h[0];h[1]=h[1]+g.h[1];h[2]=h[2]+g.h[2];h[3]=h[3]+g.h[3];return this;} LC( g){h[0]=h[0]-g.h[0];h[1]=h[1]-g.h[1];h[2]=h[2]-g.h[2];h[3]=h[3]-g.h[3];return this;} gC(){h[0]=-h[0];h[1]=-h[1];h[2]=-h[2];h[3]=-h[3];return this;} transform( g){var k=(h[0]*g.h[0])+(h[2]*g.h[1]);var i=(h[1]*g.h[0])+(h[3]*g.h[1]);g.x=k;g.y=i;return g;}}class VB{}